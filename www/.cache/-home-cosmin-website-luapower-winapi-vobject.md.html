<h2 id="requirewinapi.vobject"><code>require'winapi.vobject'</code></h2>
<p>This module defines the <code>VObject</code> class which implements virtual properties.</p>
<p>Virtual properties means that:</p>
<ul>
<li><code>x = foo.bar</code> calls <code>foo:get_bar() -&gt; x</code>, and</li>
<li><code>foo.bar = x</code> calls <code>foo:set_bar(x)</code>.</li>
</ul>
<p>If there's a <code>set_bar</code> but no <code>get_bar</code> defined, setting <code>foo.bar = x</code> sets <code>foo.__state.bar = x</code> and later <code>x = foo.bar</code> returns the value of <code>foo._state.bar</code>. These are called &quot;stored properties&quot;.</p>
<p>If there's a <code>get_bar</code> but no <code>set_bar</code>, doing <code>foo.bar = x</code> raises an error. These are called &quot;read-only properties&quot;.</p>
<h2 id="vobject">VObject</h2>
<h3 id="hierarchy">Hierarchy</h3>
<ul>
<li><a href="/winapi.object">Object</a>
<ul>
<li>VObject</li>
</ul></li>
</ul>
<h3 id="methods">Methods</h3>
<table>
<tbody>
<tr class="odd">
<td align="left"><strong>subclassing</strong></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code>__gen_vproperties(names, getter, setter)</code></td>
<td align="left">generate virtual properties in bulk</td>
</tr>
<tr class="odd">
<td align="left"><strong>introspection</strong></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><code>__vproperties() -&gt; iter() -&gt; prop, info</code></td>
<td align="left">iterate all virtual properties</td>
</tr>
</tbody>
</table>
<h3 id="generating-properties-in-bulk">Generating properties in bulk</h3>
<p>Calling <code>Foo:__gen_vproperties({foo = true, bar = true}, getter, setter)</code> generates getters and setters for <code>foo</code> and <code>bar</code> properties based on <code>getter</code> and <code>setter</code> such that:</p>
<pre><code>get_foo(self)           calls getter(self, &#39;foo&#39;)
get_bar(self)           calls getter(self, &#39;bar&#39;)
set_foo(self, val)      calls setter(self, &#39;foo&#39;, val)
set_bar(self, val)      calls setter(self, &#39;bar&#39;, val)</code></pre>
