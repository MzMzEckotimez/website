<h2 id="requirewinapi.windowclass"><code>require'winapi.windowclass'</code></h2>
<p>This module implements the <code>Window</code> class for creating top-level windows.</p>
<h2 id="window">Window</h2>
<h3 id="hierarchy">Hierarchy</h3>
<ul>
<li><a href="/winapi.object">Object</a>
<ul>
<li><a href="/winapi.vobject">VObject</a>
<ul>
<li><a href="/winapi.basewindowclass">BaseWindow</a>
<ul>
<li>Window</li>
</ul></li>
</ul></li>
</ul></li>
</ul>
<h3 id="initial-fields-and-properties">Initial fields and properties</h3>
<div class="small">
<p><strong>NOTE:</strong> in the table below <code>i</code> means initial field, <code>r</code> means property which can be read, <code>w</code> means property which can be set.</p>
<table>
<tbody>
<tr class="odd">
<td align="left"><strong>positioning</strong></td>
<td align="left"><strong>irw</strong></td>
<td align="left"><strong>description</strong></td>
<td align="left"><strong>default</strong></td>
<td align="left"><strong>reference</strong></td>
</tr>
<tr class="even">
<td align="left">x, y</td>
<td align="left">irw</td>
<td align="left">frame position</td>
<td align="left">CW_USEDEFAULT</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">w, h</td>
<td align="left">irw</td>
<td align="left">frame size</td>
<td align="left">CW_USEDEFAULT</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><strong>customization</strong></td>
<td align="left"><strong>irw</strong></td>
<td align="left"><strong>description</strong></td>
<td align="left"><strong>default</strong></td>
<td align="left"><strong>reference</strong></td>
</tr>
<tr class="odd">
<td align="left">title</td>
<td align="left">irw</td>
<td align="left">titlebar</td>
<td align="left">''</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">background</td>
<td align="left">irw</td>
<td align="left">background color</td>
<td align="left">COLOR_WINDOW</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">cursor</td>
<td align="left">irw</td>
<td align="left">default cursor</td>
<td align="left">IDC_ARROW</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">icon</td>
<td align="left">irw</td>
<td align="left">window's icon</td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">small_icon</td>
<td align="left">irw</td>
<td align="left">window's small icon</td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">vscroll</td>
<td align="left">irw</td>
<td align="left">vertical scrollbar</td>
<td align="left">false</td>
<td align="left">WS_VSCROLL</td>
</tr>
<tr class="odd">
<td align="left">hscroll</td>
<td align="left">irw</td>
<td align="left">horizontal scrollbar</td>
<td align="left">false</td>
<td align="left">WS_HSCROLL</td>
</tr>
<tr class="even">
<td align="left">menu</td>
<td align="left">irw</td>
<td align="left">menu bar</td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">accelerators</td>
<td align="left">rw</td>
<td align="left">accelerators</td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><strong>state</strong></td>
<td align="left"><strong>irw</strong></td>
<td align="left"><strong>description</strong></td>
<td align="left"><strong>default</strong></td>
<td align="left"><strong>reference</strong></td>
</tr>
<tr class="odd">
<td align="left">minimized</td>
<td align="left">ir</td>
<td align="left">minimized state</td>
<td align="left">false</td>
<td align="left">WS_MINIMIZE</td>
</tr>
<tr class="even">
<td align="left">maximized</td>
<td align="left">ir</td>
<td align="left">maximized state</td>
<td align="left">false</td>
<td align="left">WS_MAXIMIZE</td>
</tr>
<tr class="odd">
<td align="left">foreground</td>
<td align="left">r</td>
<td align="left">foreground state</td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">normal_rect</td>
<td align="left">rw</td>
<td align="left">frame rect in normal state</td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">restore_to_maximized</td>
<td align="left">rw</td>
<td align="left">unminimize to maximized state</td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">owner</td>
<td align="left">irw</td>
<td align="left">window's owner</td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><strong>behavior</strong></td>
<td align="left"><strong>irw</strong></td>
<td align="left"><strong>description</strong></td>
<td align="left"><strong>default</strong></td>
<td align="left"><strong>reference</strong></td>
</tr>
<tr class="even">
<td align="left">autoquit</td>
<td align="left">irw</td>
<td align="left">stop the loop when closed</td>
<td align="left">false</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">closeable</td>
<td align="left">irw</td>
<td align="left">can be closed</td>
<td align="left">false</td>
<td align="left">CS_NOCLOSE</td>
</tr>
<tr class="even">
<td align="left">minimizable</td>
<td align="left">irw</td>
<td align="left">can be minimized</td>
<td align="left">true</td>
<td align="left">WS_MINIMIZEBOX</td>
</tr>
<tr class="odd">
<td align="left">maximizable</td>
<td align="left">irw</td>
<td align="left">can be maximized</td>
<td align="left">true</td>
<td align="left">WS_MAXIMIZEBOX</td>
</tr>
<tr class="even">
<td align="left">resizeable</td>
<td align="left">irw</td>
<td align="left">can be resized</td>
<td align="left">true</td>
<td align="left">WS_SIZEBOX</td>
</tr>
<tr class="odd">
<td align="left">activable</td>
<td align="left">irw</td>
<td align="left">activate and show on taskbar</td>
<td align="left">true</td>
<td align="left">WS_EX_NOACTIVATE</td>
</tr>
<tr class="even">
<td align="left">topmost</td>
<td align="left">irw</td>
<td align="left">stay above all windows</td>
<td align="left">false</td>
<td align="left">WS_EX_TOPMOST</td>
</tr>
<tr class="odd">
<td align="left">help_button</td>
<td align="left">irw</td>
<td align="left">help button</td>
<td align="left">false</td>
<td align="left">WS_EX_CONTEXTHELP</td>
</tr>
<tr class="even">
<td align="left">sysmenu</td>
<td align="left">irw</td>
<td align="left">system menu</td>
<td align="left">true</td>
<td align="left">WS_SYSMENU</td>
</tr>
<tr class="odd">
<td align="left">receive_double_clicks</td>
<td align="left">irw</td>
<td align="left">enable double click events</td>
<td align="left">true</td>
<td align="left">CS_DBLCLKS</td>
</tr>
<tr class="even">
<td align="left">clip_children</td>
<td align="left">irw</td>
<td align="left">clip children</td>
<td align="left">true</td>
<td align="left">WS_CLIPCHILDREN</td>
</tr>
<tr class="odd">
<td align="left">clip_siblings</td>
<td align="left">irw</td>
<td align="left">clip siblings</td>
<td align="left">true</td>
<td align="left">WS_CLIPSIBLINGS</td>
</tr>
<tr class="even">
<td align="left">layered</td>
<td align="left">irw</td>
<td align="left">layered mode</td>
<td align="left">false</td>
<td align="left">WS_EX_LAYERED</td>
</tr>
<tr class="odd">
<td align="left">own_dc</td>
<td align="left">irw</td>
<td align="left">own the DC</td>
<td align="left">false</td>
<td align="left">CS_OWNDC</td>
</tr>
<tr class="even">
<td align="left">control_parent</td>
<td align="left">irw</td>
<td align="left">recursive tabbing between controls</td>
<td align="left">true</td>
<td align="left">WS_EX_CONTROLPARENT</td>
</tr>
<tr class="odd">
<td align="left">taskbar_button</td>
<td align="left">irw</td>
<td align="left">force showing on taskbar</td>
<td align="left">false</td>
<td align="left">WS_EX_APPWINDOW</td>
</tr>
<tr class="even">
<td align="left">remember_maximized_pos</td>
<td align="left">irw</td>
<td align="left">maximize to last known position</td>
<td align="left">false</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">child</td>
<td align="left">irw</td>
<td align="left">(for non-activable tool windows)</td>
<td align="left">false</td>
<td align="left">WS_CHILD</td>
</tr>
<tr class="even">
<td align="left"><strong>framing</strong></td>
<td align="left"><strong>irw</strong></td>
<td align="left"><strong>description</strong></td>
<td align="left"><strong>default</strong></td>
<td align="left"><strong>reference</strong></td>
</tr>
<tr class="odd">
<td align="left">border</td>
<td align="left">irw</td>
<td align="left">add a border</td>
<td align="left">true</td>
<td align="left">WS_BORDER</td>
</tr>
<tr class="even">
<td align="left">frame</td>
<td align="left">irw</td>
<td align="left">add a titlebar (needs border)</td>
<td align="left">true</td>
<td align="left">WS_DLGFRAME</td>
</tr>
<tr class="odd">
<td align="left">window_edge</td>
<td align="left">irw</td>
<td align="left">(needs to be the same as frame)</td>
<td align="left">true</td>
<td align="left">WS_EX_WINDOWEDGE</td>
</tr>
<tr class="even">
<td align="left">dropshadow</td>
<td align="left">irw</td>
<td align="left">(for non-movable windows)</td>
<td align="left">false</td>
<td align="left">CS_DROPSHADOW</td>
</tr>
<tr class="odd">
<td align="left">tool_window</td>
<td align="left">irw</td>
<td align="left">tool window frame</td>
<td align="left">false</td>
<td align="left">WS_EX_TOOLWINDOW</td>
</tr>
<tr class="even">
<td align="left">dialog_frame</td>
<td align="left">irw</td>
<td align="left">double border and no sysmenu icon</td>
<td align="left">false</td>
<td align="left">WS_EX_DLGMODALFRAME</td>
</tr>
<tr class="odd">
<td align="left">transparent</td>
<td align="left">irw</td>
<td align="left">(use layered instead)</td>
<td align="left">false</td>
<td align="left">WS_EX_TRANSPARENT</td>
</tr>
</tbody>
</table>
</div>
<h3 id="methods">Methods</h3>
<div class="small">
<table>
<tbody>
<tr class="odd">
<td align="left"><strong>state</strong></td>
<td align="left"><strong>description</strong></td>
<td align="left"><strong>reference</strong></td>
</tr>
<tr class="even">
<td align="left">close()</td>
<td align="left">destroy the window</td>
<td align="left">CloseWindow</td>
</tr>
<tr class="odd">
<td align="left">activate()</td>
<td align="left">activate the window if the app is active</td>
<td align="left">SetActiveWindow</td>
</tr>
<tr class="even">
<td align="left">setforeground()</td>
<td align="left">activate the window anyway</td>
<td align="left">SetForegroundWindow</td>
</tr>
<tr class="odd">
<td align="left">minimize([deactivate], [async])</td>
<td align="left">minimize (deactivate: true)</td>
<td align="left">ShowWindow</td>
</tr>
<tr class="even">
<td align="left">maximize(nil, [async])</td>
<td align="left">maximize and activate</td>
<td align="left">ShowWindow</td>
</tr>
<tr class="odd">
<td align="left">shownormal([activate], [async])</td>
<td align="left">show in normal state (activate: true)</td>
<td align="left">ShowWindow</td>
</tr>
<tr class="even">
<td align="left">restore(nil, [async])</td>
<td align="left">restore from minimized or maximized state</td>
<td align="left">ShowWindow</td>
</tr>
<tr class="odd">
<td align="left">set_normal_rect(x, y, w, h)</td>
<td align="left">set the normal_rect discretely</td>
<td align="left">SetWindowPlacement</td>
</tr>
<tr class="even">
<td align="left"><strong>z-order</strong></td>
<td align="left"><strong>description</strong></td>
<td align="left"><strong>reference</strong></td>
</tr>
<tr class="odd">
<td align="left">send_to_back([rel_to_win])</td>
<td align="left">move below other windows/specific window</td>
<td align="left">SetWindowPos</td>
</tr>
<tr class="even">
<td align="left">bring_to_front([rel_to_win])</td>
<td align="left">move above other windows/specific window</td>
<td align="left">SetWindowPos</td>
</tr>
</tbody>
</table>
</div>
<h3 id="events">Events</h3>
<div class="small">
<table>
<tbody>
<tr class="odd">
<td align="left"><strong>state</strong></td>
<td align="left"><strong>description</strong></td>
<td align="left"><strong>reference</strong></td>
</tr>
<tr class="even">
<td align="left">on_close()</td>
<td align="left">was closed</td>
<td align="left">WM_CLOSE</td>
</tr>
<tr class="odd">
<td align="left">on_activate()</td>
<td align="left">was activated</td>
<td align="left">WM_ACTIVATE</td>
</tr>
<tr class="even">
<td align="left">on_deactivate()</td>
<td align="left">was deactivated</td>
<td align="left">WM_ACTIVATE</td>
</tr>
<tr class="odd">
<td align="left">on_activate_app()</td>
<td align="left">the app was activated</td>
<td align="left">WM_ACTIVATEAPP</td>
</tr>
<tr class="even">
<td align="left">on_deactivate_app()</td>
<td align="left">the app was deactivated</td>
<td align="left">WM_ACTIVATEAPP</td>
</tr>
<tr class="odd">
<td align="left">on_nc_activate()</td>
<td align="left">the non-client area was activated</td>
<td align="left">WM_NCACTIVATE</td>
</tr>
<tr class="even">
<td align="left">on_nc_deactivate()</td>
<td align="left">the non-client area was deactivated</td>
<td align="left">WM_NCACTIVATE</td>
</tr>
<tr class="odd">
<td align="left">on_minimizing(x, y)</td>
<td align="left">minimizing: return false to prevent</td>
<td align="left">SC_MINIMIZE</td>
</tr>
<tr class="even">
<td align="left">on_unminimizing()</td>
<td align="left">unminimizing: return false to prevent</td>
<td align="left">WM_QUERYOPEN</td>
</tr>
<tr class="odd">
<td align="left">on_maximizing(x, y)</td>
<td align="left">maximizing: return false to prevent</td>
<td align="left">SC_MAXIMIZE</td>
</tr>
<tr class="even">
<td align="left">on_restoring(x, y)</td>
<td align="left">unmaximizing: return false to prevent</td>
<td align="left">SC_RESTORE</td>
</tr>
<tr class="odd">
<td align="left">on_menu_key(char_code)</td>
<td align="left">get the 'f' in Alt+F on a '&amp;File' menu</td>
<td align="left">SC_KEYMENU</td>
</tr>
<tr class="even">
<td align="left">on_get_minmax_info(MINMAXINFO)</td>
<td align="left">set the min/max size constraints</td>
<td align="left">WM_GETMINMAXINFO</td>
</tr>
<tr class="odd">
<td align="left"><strong>system events</strong></td>
<td align="left"><strong>description</strong></td>
<td align="left"><strong>winapi message</strong></td>
</tr>
<tr class="even">
<td align="left">on_query_end_session()</td>
<td align="left">logging off (return false to prevent)</td>
<td align="left">WM_QUERYENDSESSION</td>
</tr>
<tr class="odd">
<td align="left">on_end_session()</td>
<td align="left">logging off (after all apps agreed)</td>
<td align="left">WM_ENDSESSION</td>
</tr>
<tr class="even">
<td align="left">on_system_color_change()</td>
<td align="left">system colors changed</td>
<td align="left">WM_SYSCOLORCHANGE</td>
</tr>
<tr class="odd">
<td align="left">on_settings_change()</td>
<td align="left">system parameters info changed</td>
<td align="left">WM_SETTINGCHANGE</td>
</tr>
<tr class="even">
<td align="left">on_device_mode_change()</td>
<td align="left">device-mode settings changed</td>
<td align="left">WM_DEVMODECHANGE</td>
</tr>
<tr class="odd">
<td align="left">on_fonts_change()</td>
<td align="left">installed fonts changed</td>
<td align="left">WM_FONTCHANGE</td>
</tr>
<tr class="even">
<td align="left">on_time_change()</td>
<td align="left">system time changed</td>
<td align="left">WM_TIMECHANGE</td>
</tr>
<tr class="odd">
<td align="left">on_spooler_change()</td>
<td align="left">spooler's status changed</td>
<td align="left">WM_SPOOLERSTATUS</td>
</tr>
<tr class="even">
<td align="left">on_input_language_change()</td>
<td align="left">input language changed</td>
<td align="left">WM_INPUTLANGCHANGE</td>
</tr>
<tr class="odd">
<td align="left">on_user_change()</td>
<td align="left">used has logged off</td>
<td align="left">WM_USERCHANGED</td>
</tr>
<tr class="even">
<td align="left">on_display_change()</td>
<td align="left">display resolution changed</td>
<td align="left">WM_DISPLAYCHANGE</td>
</tr>
</tbody>
</table>
</div>
